<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.main.careerbro.modules.user.dao.UserDao">

    <sql id="userColumns">
       a.id as id,
       col.cname as college,
       a.email as email,
       a.nickname as nickname,
       a.photo_path as photoPath,
       a.open_id as openid
    </sql>

    <sql id="userJoins">
        JOIN college col ON col.id = a.college_id
    </sql>


    <select id="getUser" resultType="com.main.careerbro.modules.user.entity.User">
        SELECT
        <include refid="userColumns" />
        FROM user a
        <include refid="userJoins" />
        WHERE a.open_id = #{openid}
    </select>

    <insert id="saveUser">
        INSERT INTO user(
        id,
        college_id,
        email,
        nickname,
        photo_path,
        open_id,
        register_time
        ) VALUES (
        #{id},
        #{college},
        #{email},
        #{nikeName},
        #{photoPath},
        #{openid},
        NOW()
        )
    </insert>


</mapper>